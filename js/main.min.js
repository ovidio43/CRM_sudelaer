var i=$("#initRows").val();$(document).ready(function(){$("#is_checked").on("click",function(){$("select#id_template_ext").toggleClass("hidden")});$(".force-redirect").on("click",function(){location.href=$(this).attr("href")});$(".nav-tabs a").click(function(a){a.preventDefault();if($(this).hasClass("disabled")){a.preventDefault();return false}});$(".migrate-link").on("click",function(c){c.preventDefault();var b=$(this);var a=confirm("Are you sure to migrate this selected item to contacts?");if(a!==false){$.get(b.attr("href"),function(d){if(d==="ok"){b.parent().parent().remove()}}).complete(function(){})}});$(".delete-link").on("click",function(c){c.preventDefault();var b=$(this);var a=confirm("Are you sure to delete this selected item?");if(a!==false){$.post(b.attr("href"),function(d){if(d==="ok"){b.parent().parent().remove()}})}});$("input#mobile").on("keyup",function(){var c="";var a=$(this).val();var b=$(this).attr("rel");if(a.length>=10&&$.isNumeric(a)){$.get($("body").attr("rel")+"/leads/verify-mobile-number/"+a+"/"+b,function(d){if(d!=""){$("#global-modal #title-global-modal").html('Mobile number <strong>"'+a+'"</strong>  already exists!');$("#global-modal-body").html(d);$("#global-modal").modal("show")}})}});$("body").on("click","a.link-send-sms",function(a){a.preventDefault();$("#global-modal-body").html("Loading...");$("#global-modal #title-global-modal").html("Send SMS");$("#global-modal").modal("show");$.get($(this).attr("href"),function(b){$("#global-modal-body").html(b)})});$("body").on("click",".listingblock > .four > .vignette > a",function(a){a.preventDefault()});$("body").on("click","a.link-get-car-type",function(a){a.preventDefault();$("#aux").val($(this).attr("rel"));$("#myModal").modal("show")});$("#myModal").on("show.bs.modal",function(){$("#modal-body").text("Loading..");$.get(getUrl(),function(a){$("#modal-body").empty().append($(a).find(".twelve").children())})});$("body").on("click","a.page,a.nextpostslink,a.last,a.first,a.previouspostslink",function(b){b.preventDefault();var a=$(this).attr("href");$("#modal-body").text("Loading..");$.post(a,function(c){$("#modal-body").empty().append($(c).find(".twelve").children())})});$("body").on("click",".listingblock",function(b){var c=$("#aux").val();var a=$(this).find("h4.address").text().split("#");$("#year"+c).val($(this).find("span.model-year-crm").text());$("#make"+c).val($(this).find("span.make-crm").text());$("#model"+c).val($(this).find("span.model-crm").text());$("#stock"+c).val(a[1].trim());$("#myModal").modal("hide")});$("body").on("click","#link-add-row-carType",function(b){b.preventDefault();$(this).before(getHtmlInputsCarType(i));var a=addInd(i,$("#rows").val());$("#rows").val(a);i++});$("body").on("click",".link-remove-row-carType",function(c){c.preventDefault();var b=$(this).attr("rel");$(this).parent().parent().parent().remove();var a=deleteInd(b,$("#rows").val());$("#rows").val(a)});$("body").on("click",".link-delete-row-carType",function(c){c.preventDefault();var b=$(this);var a=confirm("Â¿Esta seguro de eliminar el item?");if(a!==false){$.post(b.attr("href"),function(f){if(f==="ok"){var e=b.attr("rel");var d=deleteInd(e,$("#rows").val());$("#rows").val(d);b.parent().parent().parent().remove()}})}});$("body").on("click",".save-activity",function(f){f.preventDefault();var a=$(this);var b=a.attr("href");var c=a.parent().parent();var d={};c.find("input").each(function(){d[this.name]=this.value});c.find("textarea").each(function(){d[this.name]=this.value});c.find("select").each(function(){d[this.name]=this.value});a.attr("href","").text("Processong..");$.post(b,d,function(e){if(e==="ok"){document.location.reload()}else{a.attr("href",b).text("Save");alert(e)}})});$("#end-visit-form").submit(function(){var a=$(this).attr("action");var b=$(this).serialize();$.post(a,b,function(c){if(c==="ok"){document.location.reload()}else{alert("Description empty!!")}});return false});$("#show-data-end-visit").click(function(a){a.preventDefault();$("#data-end-visit").removeClass("hidden");$(this).hide()});$("a.link-show-memo").on("click",function(a){a.preventDefault();$(this).siblings("div").toggleClass("hidden");var b=$(this).text()==="Close"?"Memo":"Close";$(this).text(b)});$("a.link-cancel-memo").on("click",function(a){a.preventDefault();$(this).parent().toggleClass("hidden")});$("a.link-save-memo").on("click",function(b){b.preventDefault();var a=$(this);a.fadeOut();a.after("<span>Please wait..</span>");$.post(a.attr("href"),{memo_short:a.siblings("textarea").val()},function(c){if(c==="ok"){a.next().fadeOut();a.fadeIn()}})});$("body").on("submit",".global-form",function(c){c.preventDefault();var d=$(this);var a=d.attr("action");var b=d.serialize();d.children('input[type="submit"]').prop("disabled",true);$.post(a,b,function(e){if(e=="ok"){d.parent().html('<div class="alert alert-success" role="alert">Your message was sent successfully.</div><button type="button" class="btn btn-success" data-dismiss="modal">DONE</button>');d.remove()}else{d.prev().remove();d.before(e);d.children('input[type="submit"]').prop("disabled",false)}})})});function getUrl(){var a=$("#aux").val();var b="/search-results-crm/?make="+$("#make"+a).val()+"&model-year="+$("#year"+a).val()+"&stock-number="+$("#stock"+a).val();return b}function addInd(a,b){return b+a+","}function deleteInd(a,b){b=b.replace(a,"");return b.replace(",,",",")}function getHtmlInputsCarType(a){var b='<div class="form-group"><div class="row"><div class="col-sm-2"><label for="make'+a+'">Make</label><input type="text" id="make'+a+'" value="" name="make'+a+'" class="form-control"> </div><div class="col-sm-2"><label for="year'+a+'">Year</label><input type="text" id="year'+a+'" value="" name="year'+a+'" class="form-control"></div><div class="col-sm-2" ><label for="stock'+a+'">Stock</label><input type="text" id="stock'+a+'" value="" name="stock'+a+'" class="form-control"></div><div class="col-sm-2"><label for="model'+a+'">Model</label><input type="text" id="model'+a+'" value="" name="model'+a+'" class="form-control"></div><div class="col-sm-2"><label for="budget'+a+'">Budget</label><input type="text" id="budget'+a+'" value="" name="budget'+a+'" class="form-control"></div><div class="col-sm-2"><br><a rel="'+a+'" href="#" class="btn btn-primary link-get-car-type" role="button"><span class="glyphicon glyphicon-plus"></span></a>  <a rel="'+a+'" class="link-remove-row-carType btn btn-primary btn-danger" href="#" title="REMOVE" role="button" ><span class=" glyphicon glyphicon-remove"></span></a></div></div></div>';return b};